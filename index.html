<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Tracker - Smart Money Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4C4BCB'
                    }
                }
            }
        }
    </script>
    <style>
        .hide { display: none !important; }
        .fade-in { animation: fadeIn 0.2s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .slide-up { animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        input:focus { outline: none; }
        .transaction-item { transition: all 0.15s ease; }
        .transaction-item:hover { transform: translateY(-1px); }
        .calculator-btn { transition: all 0.1s ease; }
        .calculator-btn:hover { transform: scale(1.05); }
        .calculator-btn:active { transform: scale(0.95); }
        .tab-btn.active {
            background-color: #5D5CDE;
            color: white;
            box-shadow: 0 2px 8px rgba(93, 92, 222, 0.3);
        }
        .tab-btn {
            color: #6B7280;
            background-color: transparent;
            transition: all 0.2s ease;
            flex: 1;
            min-width: 0;
        }
        .tab-btn:hover:not(.active) {
            background-color: #F3F4F6;
            color: #374151;
        }
        .dark .tab-btn:hover:not(.active) {
            background-color: #4B5563;
            color: #D1D5DB;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #5D5CDE 0%, #4C4BCB 100%);
        }
        .card-hover {
            transition: all 0.2s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .dark .card-hover:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .pulse-ring {
            animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(2.4); opacity: 0; }
        }
        .emoji-bounce {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
            60% { transform: translateY(-3px); }
        }
        .tab-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 4px;
        }
        @media (max-width: 640px) {
            .tab-btn span:last-child {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen">
    <!-- Header Navigation -->
    <header class="gradient-bg text-white shadow-xl sticky top-0 z-40">
        <div class="px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="bg-white bg-opacity-20 p-2 rounded-xl relative">
                        <span class="text-2xl emoji-bounce">üí∞</span>
                        <div class="absolute inset-0 bg-white opacity-20 rounded-xl pulse-ring"></div>
                    </div>
                    <div>
                        <h1 id="appTitle" class="text-xl font-bold">Budget Tracker</h1>
                        <p id="appSubtitle" class="text-sm text-white text-opacity-80">Smart Money Management</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <!-- Language Switcher -->
                    <select id="languageSelect" class="bg-white bg-opacity-20 text-white text-xs rounded-lg p-2 border-0">
                        <option value="en">üá∫üá∏ EN</option>
                        <option value="ne">üá≥üáµ NE</option>
                    </select>
                    <button id="calculatorBtn" class="p-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-all">
                        <i class="fas fa-calculator text-sm"></i>
                    </button>
                    <button id="searchBtn" class="p-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-all">
                        <i class="fas fa-search text-sm"></i>
                    </button>
                    <button id="menuBtn" class="p-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-all">
                        <i class="fas fa-ellipsis-v text-sm"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Search Bar -->
        <div id="searchBar" class="px-4 pb-4 hide">
            <div class="relative">
                <input type="text" id="searchInput" class="w-full px-4 py-2 pl-10 bg-white bg-opacity-20 rounded-lg text-white placeholder-white placeholder-opacity-70 border border-white border-opacity-30 focus:border-opacity-50 text-base">
                <i class="fas fa-search absolute left-3 top-2.5 text-white text-opacity-70"></i>
            </div>
        </div>
    </header>

    <!-- Menu Dropdown -->
    <div id="menuDropdown" class="hide fixed top-20 right-4 bg-white dark:bg-gray-800 rounded-xl shadow-xl z-50 min-w-48">
        <div class="py-2">
            <button id="exportBtn" class="w-full px-4 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2">
                <i class="fas fa-download"></i>
                <span id="exportText">Export Data</span>
            </button>
            <button id="privacyBtn" class="w-full px-4 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2">
                <i class="fas fa-shield-alt"></i>
                <span id="privacyText">Privacy Policy</span>
            </button>
            <button id="aboutBtn" class="w-full px-4 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2">
                <i class="fas fa-info-circle"></i>
                <span id="aboutText">About</span>
            </button>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="bg-white dark:bg-gray-800 px-4 py-3 shadow-lg border-b border-gray-200 dark:border-gray-600 sticky top-20 z-30">
        <div class="flex justify-between items-center">
            <div class="tab-container bg-gray-100 dark:bg-gray-900 p-1 rounded-xl shadow-inner w-full max-w-md">
                <button id="dashboardTab" class="tab-btn active px-2 py-2 rounded-lg text-xs font-medium flex flex-col items-center space-y-1">
                    <span>üìä</span><span id="dashboardTabText">Dashboard</span>
                </button>
                <button id="transactionsTab" class="tab-btn px-2 py-2 rounded-lg text-xs font-medium flex flex-col items-center space-y-1">
                    <span>üí≥</span><span id="transactionsTabText">Transactions</span>
                </button>
                <button id="analyticsTab" class="tab-btn px-2 py-2 rounded-lg text-xs font-medium flex flex-col items-center space-y-1">
                    <span>üìà</span><span id="analyticsTabText">Analytics</span>
                </button>
                <button id="goalsTab" class="tab-btn px-2 py-2 rounded-lg text-xs font-medium flex flex-col items-center space-y-1">
                    <span>üéØ</span><span id="goalsTabText">Goals</span>
                </button>
            </div>
            <div class="ml-3">
                <select id="sortBy" class="px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-xs">
                </select>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="p-4 pb-32">
        <!-- Dashboard Tab -->
        <div id="dashboardContent" class="tab-content">
            <div class="space-y-4">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 gap-4">
                    <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-xl border border-green-200 dark:border-green-800 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 id="totalIncomeLabel" class="text-green-700 dark:text-green-300 text-sm font-medium">Total Income</h3>
                                <p id="totalIncome" class="text-2xl font-bold text-green-800 dark:text-green-200">$0.00</p>
                            </div>
                            <div class="text-3xl text-green-600">üí∞</div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-4 rounded-xl border border-red-200 dark:border-red-800 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 id="totalExpensesLabel" class="text-red-700 dark:text-red-300 text-sm font-medium">Total Expenses</h3>
                                <p id="totalExpenses" class="text-2xl font-bold text-red-800 dark:text-red-200">$0.00</p>
                            </div>
                            <div class="text-3xl text-red-600">üí∏</div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800 card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 id="netBalanceLabel" class="text-blue-700 dark:text-blue-300 text-sm font-medium">Net Balance</h3>
                                <p id="netBalance" class="text-2xl font-bold text-blue-800 dark:text-blue-200">$0.00</p>
                            </div>
                            <div class="text-3xl text-blue-600">üè¶</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm card-hover">
                    <h3 id="recentTransactionsLabel" class="text-lg font-semibold mb-3 flex items-center">
                        <span class="mr-2">üïí</span>Recent Transactions
                    </h3>
                    <div id="recentTransactions" class="space-y-2">
                        <p id="noTransactionsText" class="text-gray-500 dark:text-gray-400 text-center py-8">No transactions yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transactions Tab -->
        <div id="transactionsContent" class="tab-content hide">
            <div class="space-y-4">
                <!-- Filter Controls -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm">
                    <div class="grid grid-cols-2 gap-2">
                        <select id="filterType" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </select>
                        <select id="filterCategory" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </select>
                    </div>
                </div>

                <!-- Transactions List -->
                <div id="transactionsList" class="space-y-2">
                    <p class="text-gray-500 dark:text-gray-400 text-center py-8">No transactions found</p>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analyticsContent" class="tab-content hide">
            <div class="space-y-6">
                <!-- Quick Stats Cards -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-xl text-center border border-purple-200 dark:border-purple-800 card-hover">
                        <div class="text-2xl mb-1">üìä</div>
                        <p id="totalTransactionsLabel" class="text-xs text-purple-700 dark:text-purple-300">Total Transactions</p>
                        <p id="totalTransactions" class="text-lg font-bold text-purple-800 dark:text-purple-200">0</p>
                    </div>
                    <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-xl text-center border border-yellow-200 dark:border-yellow-800 card-hover">
                        <div class="text-2xl mb-1">üí∞</div>
                        <p id="avgDailySpendLabel" class="text-xs text-yellow-700 dark:text-yellow-300">Avg. Daily Spend</p>
                        <p id="avgDailySpend" class="text-lg font-bold text-yellow-800 dark:text-yellow-200">$0</p>
                    </div>
                    <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-xl text-center border border-indigo-200 dark:border-indigo-800 card-hover">
                        <div class="text-2xl mb-1">üìà</div>
                        <p id="highestExpenseLabel" class="text-xs text-indigo-700 dark:text-indigo-300">Highest Expense</p>
                        <p id="highestExpense" class="text-lg font-bold text-indigo-800 dark:text-indigo-200">$0</p>
                    </div>
                    <div class="bg-pink-50 dark:bg-pink-900/20 p-4 rounded-xl text-center border border-pink-200 dark:border-pink-800 card-hover">
                        <div class="text-2xl mb-1">üéØ</div>
                        <p id="savingsRateLabel" class="text-xs text-pink-700 dark:text-pink-300">Savings Rate</p>
                        <p id="savingsRate" class="text-lg font-bold text-pink-800 dark:text-pink-200">0%</p>
                    </div>
                </div>

                <!-- Charts -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm card-hover">
                    <h3 id="monthlyTrendsLabel" class="text-lg font-semibold mb-4">üìà Monthly Trends</h3>
                    <canvas id="trendsChart" class="w-full h-64"></canvas>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm card-hover">
                    <h3 id="categoryBreakdownLabel" class="text-lg font-semibold mb-4">üîÑ Category Breakdown</h3>
                    <canvas id="categoryChart" class="w-full h-64"></canvas>
                </div>
            </div>
        </div>

        <!-- Goals Tab -->
        <div id="goalsContent" class="tab-content hide">
            <div class="space-y-6">
                <!-- Savings Target -->
                <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-xl p-6 border border-green-200 dark:border-green-800 card-hover">
                    <h3 id="savingsTargetLabel" class="text-lg font-semibold mb-4 text-green-800 dark:text-green-200">üí∞ Savings Challenge</h3>
                    <div class="space-y-4">
                        <div>
                            <label id="monthlySavingsTargetLabel" class="block text-sm font-medium mb-2 text-green-700 dark:text-green-300">Monthly Savings Target</label>
                            <div class="flex space-x-2">
                                <input type="number" id="savingsTarget" class="flex-1 px-3 py-2 border border-green-300 dark:border-green-600 rounded-lg bg-white dark:bg-gray-800 text-base">
                                <button id="setSavingsBtn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                    <span id="setTargetText">Set</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div id="savingsProgress" class="mt-4 hide">
                        <div class="flex justify-between items-center mb-2">
                            <span id="progressText" class="text-sm font-medium text-green-700 dark:text-green-300">Progress</span>
                            <span id="savingsPercentage" class="text-sm font-medium text-green-700 dark:text-green-300">0%</span>
                        </div>
                        <div class="w-full bg-green-200 dark:bg-green-800 rounded-full h-3">
                            <div id="savingsProgressBar" class="bg-green-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                        <p id="savingsStatus" class="text-sm text-green-600 dark:text-green-400 mt-2"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Calculator Modal -->
    <div id="calculatorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl max-w-sm w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h2 id="calculatorTitle" class="text-xl font-bold">Calculator</h2>
                <button id="closeCalculator" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
                <input type="text" id="calculatorDisplay" class="w-full text-right text-2xl font-mono bg-transparent border-0 focus:outline-none" readonly value="0">
            </div>
            <div class="grid grid-cols-4 gap-2">
                <button class="calculator-btn bg-red-500 text-white p-3 rounded-lg font-semibold" onclick="clearCalculator()">C</button>
                <button class="calculator-btn bg-gray-300 dark:bg-gray-600 p-3 rounded-lg" onclick="deleteDigit()">‚å´</button>
                <button class="calculator-btn bg-blue-500 text-white p-3 rounded-lg" onclick="appendToDisplay('/')">/</button>
                <button class="calculator-btn bg-blue-500 text-white p-3 rounded-lg" onclick="appendToDisplay('*')">√ó</button>
                
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('7')">7</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('8')">8</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('9')">9</button>
                <button class="calculator-btn bg-blue-500 text-white p-3 rounded-lg" onclick="appendToDisplay('-')">-</button>
                
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('4')">4</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('5')">5</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('6')">6</button>
                <button class="calculator-btn bg-blue-500 text-white p-3 rounded-lg" onclick="appendToDisplay('+')">+</button>
                
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('1')">1</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('2')">2</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold" onclick="appendToDisplay('3')">3</button>
                <button class="calculator-btn bg-green-500 text-white p-3 rounded-lg row-span-2" onclick="calculate()">=</button>
                
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg font-semibold col-span-2" onclick="appendToDisplay('0')">0</button>
                <button class="calculator-btn bg-gray-200 dark:bg-gray-700 p-3 rounded-lg" onclick="appendToDisplay('.')">.</button>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 id="privacyPolicyTitle" class="text-xl font-bold">Privacy Policy</h2>
                <button id="closePrivacy" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="privacyContent" class="prose dark:prose-invert max-w-none">
                <p>Your privacy is important to us. This application stores data locally on your device and does not share your financial information with third parties.</p>
                <h3>Data Collection</h3>
                <ul>
                    <li>Transaction data is stored locally in your browser</li>
                    <li>No personal information is transmitted to external servers</li>
                    <li>Analytics are computed locally on your device</li>
                </ul>
                <h3>Data Usage</h3>
                <ul>
                    <li>Your data is used solely for providing budget tracking features</li>
                    <li>Financial insights are generated locally</li>
                    <li>No data is sold or shared with advertisers</li>
                </ul>
                <h3>Data Security</h3>
                <p>All data is stored securely in your browser's local storage and is encrypted.</p>
            </div>
        </div>
    </div>

    <!-- Transaction Modal -->
    <div id="transactionModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl max-w-sm w-full mx-4 slide-up">
            <h2 id="modalTitle" class="text-xl font-bold mb-4">Add Transaction</h2>
            <form id="transactionForm" class="space-y-4">
                <div>
                    <label id="typeLabel" class="block text-sm font-medium mb-1">Type</label>
                    <select id="transactionType" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base" required>
                    </select>
                </div>
                <div>
                    <label id="amountLabel" class="block text-sm font-medium mb-1">Amount</label>
                    <input type="number" id="transactionAmount" step="0.01" min="0" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base" placeholder="0.00" required>
                </div>
                <div>
                    <label id="categoryLabel" class="block text-sm font-medium mb-1">Category</label>
                    <select id="transactionCategory" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base" required>
                    </select>
                </div>
                <div>
                    <label id="descriptionLabel" class="block text-sm font-medium mb-1">Description</label>
                    <input type="text" id="transactionDescription" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                </div>
                <div>
                    <label id="dateLabel" class="block text-sm font-medium mb-1">Date</label>
                    <input type="date" id="transactionDate" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base" required>
                </div>
                <div class="flex space-x-3 pt-2">
                    <button type="button" id="cancelBtn" class="flex-1 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Cancel</button>
                    <button type="submit" id="saveBtn" class="flex-1 py-2 px-4 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hide">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl max-w-sm w-full mx-4">
            <h3 id="deleteTitle" class="text-lg font-semibold mb-4">Delete Transaction</h3>
            <p id="deleteMessage" class="text-gray-600 dark:text-gray-400 mb-6">Are you sure you want to delete this transaction? This action cannot be undone.</p>
            <div class="flex space-x-3">
                <button id="cancelDeleteBtn" class="flex-1 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Cancel</button>
                <button id="confirmDeleteBtn" class="flex-1 py-2 px-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">Delete</button>
            </div>
        </div>
    </div>

    <!-- Floating Add Button -->
    <div class="fixed bottom-24 right-4 z-30">
        <button id="floatingAddBtn" class="bg-primary text-white w-14 h-14 rounded-full shadow-xl hover:bg-primary-dark transition-all transform hover:scale-110 flex items-center justify-center">
            <i class="fas fa-plus text-xl"></i>
        </button>
    </div>

    <!-- Footer -->
    <footer class="fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-300 dark:border-gray-600 shadow-lg">
        <div class="px-4 py-3">
            <div class="flex justify-between items-center">
                <!-- Quick Actions -->
                <div class="flex space-x-6">
                    <button id="quickAddIncome" class="flex flex-col items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all group">
                        <div class="bg-green-500 p-2 rounded-full group-hover:scale-110 transition-transform">
                            <i class="fas fa-plus text-white text-sm"></i>
                        </div>
                        <span id="incomeText" class="text-xs text-green-600 dark:text-green-400 mt-1">Income</span>
                    </button>
                    <button id="quickAddExpense" class="flex flex-col items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all group">
                        <div class="bg-red-500 p-2 rounded-full group-hover:scale-110 transition-transform">
                            <i class="fas fa-minus text-white text-sm"></i>
                        </div>
                        <span id="expenseText" class="text-xs text-red-600 dark:text-red-400 mt-1">Expense</span>
                    </button>
                </div>

                <!-- Balance Info -->
                <div class="text-center">
                    <p id="footerBalance" class="text-sm font-semibold text-gray-800 dark:text-gray-200">$0.00</p>
                    <p id="netBalanceFooterText" class="text-xs text-gray-500 dark:text-gray-500">Net Balance</p>
                </div>

                <!-- Made by Sagar -->
                <div class="text-right">
                    <p class="text-xs text-gray-600 dark:text-gray-400">Made with ‚ù§Ô∏è</p>
                    <p class="text-xs font-semibold text-primary">by Sagar</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Dark mode setup
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // App State
        let transactions = [];
        let editingTransactionId = null;
        let charts = {};
        let currentLanguage = 'en';
        let currentCurrency = '$';

        // Enhanced Categories with Emojis
        const categories = {
            income: {
                en: ['üíº Salary', 'üíª Freelance', 'üìà Investment', 'üè¢ Business', 'üéÅ Gift', 'üí∞ Bonus', 'üè† Rental', 'üìö Royalty', 'üîÑ Other'],
                ne: ['üíº ‡§§‡§≤‡§¨', 'üíª ‡§∏‡•ç‡§µ‡§§‡§®‡•ç‡§§‡•ç‡§∞', 'üìà ‡§≤‡§ó‡§æ‡§®‡•Ä', 'üè¢ ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞', 'üéÅ ‡§â‡§™‡§π‡§æ‡§∞', 'üí∞ ‡§¨‡•ã‡§®‡§∏', 'üè† ‡§≠‡§æ‡§°‡§æ', 'üìö ‡§∞‡•ã‡§Ø‡§≤‡•ç‡§ü‡•Ä', 'üîÑ ‡§Ö‡§®‡•ç‡§Ø']
            },
            expense: {
                en: ['üçï Food', 'üöó Transportation', 'üéÆ Entertainment', 'üõçÔ∏è Shopping', 'üí° Bills', 'üè• Healthcare', 'üìö Education', 'üëï Clothing', 'üè† Rent', '‚òï Coffee', '‚õΩ Fuel', 'üì± Phone', 'üîÑ Other'],
                ne: ['üçï ‡§ñ‡§æ‡§®‡§æ', 'üöó ‡§Ø‡§æ‡§§‡§æ‡§Ø‡§æ‡§§', 'üéÆ ‡§Æ‡§®‡•ã‡§∞‡§û‡•ç‡§ú‡§®', 'üõçÔ∏è ‡§ï‡§ø‡§®‡§Æ‡•á‡§≤', 'üí° ‡§¨‡§ø‡§ú‡•Å‡§≤‡•Ä', 'üè• ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø', 'üìö ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ', 'üëï ‡§≤‡•Å‡§ó‡§æ', 'üè† ‡§≠‡§æ‡§°‡§æ', '‚òï ‡§ï‡§´‡•Ä', '‚õΩ ‡§á‡§®‡•ç‡§ß‡§®', 'üì± ‡§´‡•ã‡§®', 'üîÑ ‡§Ö‡§®‡•ç‡§Ø']
            }
        };

        // Translations
        const translations = {
            en: {
                appTitle: 'Budget Tracker',
                appSubtitle: 'Smart Money Management',
                addBtnText: '+ Add',
                dashboard: 'Dashboard',
                transactions: 'Transactions',
                analytics: 'Analytics',
                goals: 'Goals',
                totalIncome: 'Total Income',
                totalExpenses: 'Total Expenses',
                netBalance: 'Net Balance',
                recentTransactions: 'Recent Transactions',
                noTransactions: 'No transactions yet',
                exportData: 'Export Data',
                privacyPolicy: 'Privacy Policy',
                about: 'About',
                calculator: 'Calculator',
                income: 'Income',
                expense: 'Expense',
                type: 'Type',
                amount: 'Amount',
                category: 'Category',
                description: 'Description',
                date: 'Date',
                cancel: 'Cancel',
                save: 'Save',
                delete: 'Delete',
                deleteTransaction: 'Delete Transaction',
                deleteConfirm: 'Are you sure you want to delete this transaction? This action cannot be undone.',
                addTransaction: 'Add Transaction',
                editTransaction: 'Edit Transaction',
                allTypes: 'All Types',
                allCategories: 'All Categories',
                sortByDate: 'Sort by Date',
                sortByAmount: 'Sort by Amount',
                sortByCategory: 'Sort by Category',
                totalTransactions: 'Total Transactions',
                avgDailySpend: 'Avg. Daily Spend',
                highestExpense: 'Highest Expense',
                savingsRate: 'Savings Rate',
                monthlyTrends: 'Monthly Trends',
                categoryBreakdown: 'Category Breakdown',
                savingsChallenge: 'Savings Challenge',
                monthlySavingsTarget: 'Monthly Savings Target',
                setTarget: 'Set Target',
                progress: 'Progress',
                searchPlaceholder: 'Search transactions...',
                enterTargetAmount: 'Enter target amount',
                enterDescription: 'Enter description',
                netBalanceFooter: 'Net Balance'
            },
            ne: {
                appTitle: '‡§¨‡§ú‡•á‡§ü ‡§ü‡•ç‡§∞‡•ç‡§Ø‡§æ‡§ï‡§∞',
                appSubtitle: '‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§™‡•à‡§∏‡§æ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§®',
                addBtnText: '+ ‡§•‡§™‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                dashboard: '‡§°‡•ç‡§Ø‡§æ‡§∏‡§¨‡•ã‡§∞‡•ç‡§°',
                transactions: '‡§≤‡•á‡§®‡§¶‡•á‡§®',
                analytics: '‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£',
                goals: '‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø',
                totalIncome: '‡§ï‡•Å‡§≤ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä',
                totalExpenses: '‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö',
                netBalance: '‡§∂‡•Å‡§¶‡•ç‡§ß ‡§¨‡§ö‡§§',
                recentTransactions: '‡§π‡§æ‡§≤‡§ï‡§æ ‡§≤‡•á‡§®‡§¶‡•á‡§®',
                noTransactions: '‡§Ö‡§π‡§ø‡§≤‡•á ‡§∏‡§Æ‡•ç‡§Æ ‡§ï‡•Å‡§®‡•à ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§õ‡•à‡§®',
                exportData: '‡§°‡§æ‡§ü‡§æ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§',
                privacyPolicy: '‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ ‡§®‡•Ä‡§§‡§ø',
                about: '‡§¨‡§æ‡§∞‡•á‡§Æ‡§æ',
                calculator: '‡§ï‡•ç‡§Ø‡§æ‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞',
                income: '‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä',
                expense: '‡§ñ‡§∞‡•ç‡§ö',
                type: '‡§™‡•ç‡§∞‡§ï‡§æ‡§∞',
                amount: '‡§∞‡§ï‡§Æ',
                category: '‡§∂‡•ç‡§∞‡•á‡§£‡•Ä',
                description: '‡§µ‡§ø‡§µ‡§∞‡§£',
                date: '‡§Æ‡§ø‡§§‡§ø',
                cancel: '‡§∞‡§¶‡•ç‡§¶ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                save: '‡§∏‡•á‡§≠ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                delete: '‡§Æ‡•á‡§ü‡§æ‡§â‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                deleteTransaction: '‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§Æ‡•á‡§ü‡§æ‡§â‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                deleteConfirm: '‡§ï‡•á ‡§§‡§™‡§æ‡§à‡§Ç ‡§Ø‡•ã ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§Æ‡•á‡§ü‡§æ‡§â‡§® ‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§π‡•Å‡§®‡•Å‡§π‡•Å‡§®‡•ç‡§õ? ‡§Ø‡•ã ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§™‡•Ç‡§∞‡•ç‡§µ‡§µ‡§§ ‡§ó‡§∞‡•ç‡§® ‡§∏‡§ï‡§ø‡§Å‡§¶‡•à‡§®‡•§',
                addTransaction: '‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§•‡§™‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                editTransaction: '‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§∏‡§Æ‡•ç‡§™‡§æ‡§¶‡§® ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                allTypes: '‡§∏‡§¨‡•à ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞',
                allCategories: '‡§∏‡§¨‡•à ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä',
                sortByDate: '‡§Æ‡§ø‡§§‡§ø ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß',
                sortByAmount: '‡§∞‡§ï‡§Æ ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß',
                sortByCategory: '‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß',
                totalTransactions: '‡§ï‡•Å‡§≤ ‡§≤‡•á‡§®‡§¶‡•á‡§®',
                avgDailySpend: '‡§î‡§∏‡§§ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ñ‡§∞‡•ç‡§ö',
                highestExpense: '‡§∏‡§¨‡•à‡§≠‡§®‡•ç‡§¶‡§æ ‡§†‡•Ç‡§≤‡•ã ‡§ñ‡§∞‡•ç‡§ö',
                savingsRate: '‡§¨‡§ö‡§§ ‡§¶‡§∞',
                monthlyTrends: '‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§™‡•ç‡§∞‡§µ‡•É‡§§‡•ç‡§§‡§ø',
                categoryBreakdown: '‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§µ‡§ø‡§≠‡§æ‡§ú‡§®',
                savingsChallenge: '‡§¨‡§ö‡§§ ‡§ö‡•Å‡§®‡•å‡§§‡•Ä',
                monthlySavingsTarget: '‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§¨‡§ö‡§§ ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø',
                setTarget: '‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§∏‡•á‡§ü ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                progress: '‡§™‡•ç‡§∞‡§ó‡§§‡§ø',
                searchPlaceholder: '‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç...',
                enterTargetAmount: '‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§∞‡§ï‡§Æ ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                enterDescription: '‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç',
                netBalanceFooter: '‡§∂‡•Å‡§¶‡•ç‡§ß ‡§¨‡§ö‡§§'
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setupEventListeners();
            updateLanguage();
            updateCategoryOptions();
            document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
            updateDashboard();
            updateTransactionsList();
            updateAnalytics();
        }

        function setupEventListeners() {
            // Language switcher
            document.getElementById('languageSelect').addEventListener('change', (e) => {
                currentLanguage = e.target.value;
                currentCurrency = currentLanguage === 'ne' ? 'Rs.' : '$';
                updateLanguage();
                updateAll();
            });

            // Tab navigation
            document.getElementById('dashboardTab').addEventListener('click', () => showTab('dashboard'));
            document.getElementById('transactionsTab').addEventListener('click', () => showTab('transactions'));
            document.getElementById('analyticsTab').addEventListener('click', () => showTab('analytics'));
            document.getElementById('goalsTab').addEventListener('click', () => showTab('goals'));

            // Header buttons
            document.getElementById('floatingAddBtn').addEventListener('click', openAddModal);
            document.getElementById('searchBtn').addEventListener('click', toggleSearch);
            document.getElementById('menuBtn').addEventListener('click', toggleMenu);
            document.getElementById('calculatorBtn').addEventListener('click', openCalculator);
            document.getElementById('searchInput').addEventListener('input', handleSearch);

            // Menu dropdown
            document.getElementById('exportBtn').addEventListener('click', exportData);
            document.getElementById('privacyBtn').addEventListener('click', openPrivacyModal);
            document.getElementById('aboutBtn').addEventListener('click', showAbout);

            // Footer quick actions
            document.getElementById('quickAddIncome').addEventListener('click', () => openQuickAddModal('income'));
            document.getElementById('quickAddExpense').addEventListener('click', () => openQuickAddModal('expense'));

            // Modal controls
            document.getElementById('cancelBtn').addEventListener('click', closeModal);
            document.getElementById('transactionForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('transactionType').addEventListener('change', updateCategoryOptions);

            // Calculator
            document.getElementById('closeCalculator').addEventListener('click', closeCalculator);

            // Privacy modal
            document.getElementById('closePrivacy').addEventListener('click', closePrivacyModal);

            // Filter and sort controls
            document.getElementById('filterType').addEventListener('change', updateTransactionsList);
            document.getElementById('filterCategory').addEventListener('change', updateTransactionsList);
            document.getElementById('sortBy').addEventListener('change', updateTransactionsList);

            // Goals
            document.getElementById('setSavingsBtn').addEventListener('click', setSavingsTarget);

            // Delete modal
            document.getElementById('cancelDeleteBtn').addEventListener('click', closeDeleteModal);
            document.getElementById('confirmDeleteBtn').addEventListener('click', confirmDelete);

            // Close modals on background click
            document.addEventListener('click', (e) => {
                if (e.target === document.getElementById('transactionModal')) closeModal();
                if (e.target === document.getElementById('deleteModal')) closeDeleteModal();
                if (e.target === document.getElementById('calculatorModal')) closeCalculator();
                if (e.target === document.getElementById('privacyModal')) closePrivacyModal();
                if (!e.target.closest('#menuDropdown') && !e.target.closest('#menuBtn')) {
                    document.getElementById('menuDropdown').classList.add('hide');
                }
            });
        }

        function updateLanguage() {
            const t = translations[currentLanguage];
            
            // Update UI text
            document.getElementById('appTitle').textContent = t.appTitle;
            document.getElementById('appSubtitle').textContent = t.appSubtitle;
            document.getElementById('dashboardTabText').textContent = t.dashboard;
            document.getElementById('transactionsTabText').textContent = t.transactions;
            document.getElementById('analyticsTabText').textContent = t.analytics;
            document.getElementById('goalsTabText').textContent = t.goals;
            
            // Update labels
            document.getElementById('totalIncomeLabel').textContent = t.totalIncome;
            document.getElementById('totalExpensesLabel').textContent = t.totalExpenses;
            document.getElementById('netBalanceLabel').textContent = t.netBalance;
            document.getElementById('recentTransactionsLabel').textContent = `üïí ${t.recentTransactions}`;
            document.getElementById('noTransactionsText').textContent = t.noTransactions;
            
            // Update menu items
            document.getElementById('exportText').textContent = t.exportData;
            document.getElementById('privacyText').textContent = t.privacyPolicy;
            document.getElementById('aboutText').textContent = t.about;
            
            // Update footer
            document.getElementById('incomeText').textContent = t.income;
            document.getElementById('expenseText').textContent = t.expense;
            document.getElementById('netBalanceFooterText').textContent = t.netBalanceFooter;
            
            // Update form labels
            document.getElementById('typeLabel').textContent = t.type;
            document.getElementById('amountLabel').textContent = t.amount;
            document.getElementById('categoryLabel').textContent = t.category;
            document.getElementById('descriptionLabel').textContent = t.description;
            document.getElementById('dateLabel').textContent = t.date;
            document.getElementById('cancelBtn').textContent = t.cancel;
            document.getElementById('saveBtn').textContent = t.save;
            
            // Update analytics labels
            document.getElementById('totalTransactionsLabel').textContent = t.totalTransactions;
            document.getElementById('avgDailySpendLabel').textContent = t.avgDailySpend;
            document.getElementById('highestExpenseLabel').textContent = t.highestExpense;
            document.getElementById('savingsRateLabel').textContent = t.savingsRate;
            document.getElementById('monthlyTrendsLabel').textContent = `üìà ${t.monthlyTrends}`;
            document.getElementById('categoryBreakdownLabel').textContent = `üîÑ ${t.categoryBreakdown}`;
            
            // Update goals
            document.getElementById('savingsTargetLabel').textContent = `üí∞ ${t.savingsChallenge}`;
            document.getElementById('monthlySavingsTargetLabel').textContent = t.monthlySavingsTarget;
            document.getElementById('setTargetText').textContent = t.setTarget;
            document.getElementById('progressText').textContent = t.progress;
            
            // Update placeholders
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            document.getElementById('savingsTarget').placeholder = t.enterTargetAmount;
            document.getElementById('transactionDescription').placeholder = t.enterDescription;
            
            // Update calculator title
            document.getElementById('calculatorTitle').textContent = t.calculator;
            
            // Update delete modal
            document.getElementById('deleteTitle').textContent = t.deleteTransaction;
            document.getElementById('deleteMessage').textContent = t.deleteConfirm;
            document.getElementById('cancelDeleteBtn').textContent = t.cancel;
            document.getElementById('confirmDeleteBtn').textContent = t.delete;
            
            updateSelectOptions();
        }

        function updateSelectOptions() {
            const t = translations[currentLanguage];
            
            // Update transaction type options
            const typeSelect = document.getElementById('transactionType');
            typeSelect.innerHTML = `
                <option value="income">${t.income}</option>
                <option value="expense">${t.expense}</option>
            `;
            
            // Update filter type options
            const filterType = document.getElementById('filterType');
            filterType.innerHTML = `
                <option value="">${t.allTypes}</option>
                <option value="income">${t.income}</option>
                <option value="expense">${t.expense}</option>
            `;
            
            // Update sort options
            const sortBy = document.getElementById('sortBy');
            sortBy.innerHTML = `
                <option value="date">${t.sortByDate}</option>
                <option value="amount">${t.sortByAmount}</option>
                <option value="category">${t.sortByCategory}</option>
            `;
            
            updateCategoryOptions();
        }

        // Calculator Functions
        function openCalculator() {
            document.getElementById('calculatorModal').classList.remove('hide');
            clearCalculator();
        }

        function closeCalculator() {
            document.getElementById('calculatorModal').classList.add('hide');
        }

        function appendToDisplay(value) {
            const display = document.getElementById('calculatorDisplay');
            if (display.value === '0' && value !== '.') {
                display.value = value;
            } else {
                display.value += value;
            }
        }

        function clearCalculator() {
            document.getElementById('calculatorDisplay').value = '0';
        }

        function deleteDigit() {
            const display = document.getElementById('calculatorDisplay');
            if (display.value.length > 1) {
                display.value = display.value.slice(0, -1);
            } else {
                display.value = '0';
            }
        }

        function calculate() {
            const display = document.getElementById('calculatorDisplay');
            try {
                const result = eval(display.value.replace('√ó', '*'));
                display.value = result.toString();
            } catch (error) {
                display.value = 'Error';
                setTimeout(clearCalculator, 1500);
            }
        }

        // Menu Functions
        function toggleMenu() {
            document.getElementById('menuDropdown').classList.toggle('hide');
        }

        function openPrivacyModal() {
            document.getElementById('privacyModal').classList.remove('hide');
            document.getElementById('menuDropdown').classList.add('hide');
        }

        function closePrivacyModal() {
            document.getElementById('privacyModal').classList.add('hide');
        }

        function showAbout() {
            showCustomModal('About', 'Budget Tracker v2.0<br>A comprehensive financial management tool.<br><br>Features:<br>‚Ä¢ Multi-language support<br>‚Ä¢ Currency conversion<br>‚Ä¢ Advanced analytics<br>‚Ä¢ Built-in calculator<br>‚Ä¢ Export functionality<br><br>Made with ‚ù§Ô∏è by Sagar');
            document.getElementById('menuDropdown').classList.add('hide');
        }

        function showCustomModal(title, content) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl max-w-md w-full mx-4">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">${title}</h2>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="prose dark:prose-invert">${content}</div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function formatCurrency(amount) {
            return currentLanguage === 'ne' ? `Rs.${amount.toFixed(2)}` : `$${amount.toFixed(2)}`;
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.add('active');

            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hide'));
            document.getElementById(tabName + 'Content').classList.remove('hide');

            if (tabName === 'analytics') {
                setTimeout(updateAnalytics, 100);
            }
        }

        function openAddModal() {
            editingTransactionId = null;
            const t = translations[currentLanguage];
            document.getElementById('modalTitle').textContent = t.addTransaction;
            document.getElementById('transactionForm').reset();
            document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
            updateCategoryOptions();
            document.getElementById('transactionModal').classList.remove('hide');
        }

        function openEditModal(transaction) {
            editingTransactionId = transaction.id;
            const t = translations[currentLanguage];
            document.getElementById('modalTitle').textContent = t.editTransaction;
            document.getElementById('transactionType').value = transaction.type;
            document.getElementById('transactionAmount').value = transaction.amount;
            document.getElementById('transactionDescription').value = transaction.description;
            document.getElementById('transactionDate').value = transaction.date;
            updateCategoryOptions();
            document.getElementById('transactionCategory').value = transaction.category;
            document.getElementById('transactionModal').classList.remove('hide');
        }

        function closeModal() {
            document.getElementById('transactionModal').classList.add('hide');
            editingTransactionId = null;
        }

        function updateCategoryOptions() {
            const type = document.getElementById('transactionType').value;
            const categorySelect = document.getElementById('transactionCategory');
            const filterCategorySelect = document.getElementById('filterCategory');
            
            categorySelect.innerHTML = '';
            categories[type][currentLanguage].forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            });

            // Update filter categories
            const t = translations[currentLanguage];
            filterCategorySelect.innerHTML = `<option value="">${t.allCategories}</option>`;
            Object.values(categories).forEach(typeCategories => {
                typeCategories[currentLanguage].forEach(category => {
                    if (!filterCategorySelect.querySelector(`option[value="${category}"]`)) {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category;
                        filterCategorySelect.appendChild(option);
                    }
                });
            });
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                type: document.getElementById('transactionType').value,
                amount: parseFloat(document.getElementById('transactionAmount').value),
                category: document.getElementById('transactionCategory').value,
                description: document.getElementById('transactionDescription').value,
                date: document.getElementById('transactionDate').value
            };

            if (editingTransactionId) {
                updateTransaction(editingTransactionId, formData);
            } else {
                addTransaction(formData);
            }

            closeModal();
        }

        function addTransaction(data) {
            const transaction = {
                id: Date.now(),
                ...data,
                timestamp: new Date()
            };
            transactions.push(transaction);
            updateAll();
            showNotification(translations[currentLanguage].income === data.type ? 'Income added!' : 'Expense added!', 'success');
        }

        function updateTransaction(id, data) {
            const index = transactions.findIndex(t => t.id === id);
            if (index !== -1) {
                transactions[index] = { ...transactions[index], ...data };
                updateAll();
                showNotification('Transaction updated!', 'success');
            }
        }

        function deleteTransaction(id) {
            transactions = transactions.filter(t => t.id !== id);
            updateAll();
            showNotification('Transaction deleted!', 'success');
        }

        function openDeleteModal(transactionId) {
            document.getElementById('deleteModal').classList.remove('hide');
            document.getElementById('confirmDeleteBtn').onclick = () => {
                deleteTransaction(transactionId);
                closeDeleteModal();
            };
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.add('hide');
        }

        function confirmDelete() {
            closeDeleteModal();
        }

        function updateAll() {
            updateDashboard();
            updateTransactionsList();
            updateAnalytics();
            updateAnalyticsStats();
            updateFooterBalance();
        }

        function updateDashboard() {
            const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            const balance = income - expenses;

            document.getElementById('totalIncome').textContent = formatCurrency(income);
            document.getElementById('totalExpenses').textContent = formatCurrency(expenses);
            document.getElementById('netBalance').textContent = formatCurrency(balance);

            const recent = transactions
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);

            const recentContainer = document.getElementById('recentTransactions');
            if (recent.length === 0) {
                recentContainer.innerHTML = `<p class="text-gray-500 dark:text-gray-400 text-center py-8">${translations[currentLanguage].noTransactions}</p>`;
            } else {
                recentContainer.innerHTML = recent.map(transaction => `
                    <div class="flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg transition-all hover:bg-gray-100 dark:hover:bg-gray-600">
                        <div>
                            <p class="font-medium">${transaction.description || transaction.category}</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">${transaction.date} ‚Ä¢ ${transaction.category}</p>
                        </div>
                        <span class="font-bold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}">
                            ${transaction.type === 'income' ? '+' : '-'}${formatCurrency(transaction.amount).replace(currentCurrency, '')}
                        </span>
                    </div>
                `).join('');
            }
        }

        function updateTransactionsList() {
            const typeFilter = document.getElementById('filterType').value;
            const categoryFilter = document.getElementById('filterCategory').value;
            const sortBy = document.getElementById('sortBy').value;

            let filtered = transactions;
            if (typeFilter) {
                filtered = filtered.filter(t => t.type === typeFilter);
            }
            if (categoryFilter) {
                filtered = filtered.filter(t => t.category === categoryFilter);
            }

            switch (sortBy) {
                case 'amount':
                    filtered.sort((a, b) => b.amount - a.amount);
                    break;
                case 'category':
                    filtered.sort((a, b) => a.category.localeCompare(b.category));
                    break;
                default:
                    filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
            }

            const container = document.getElementById('transactionsList');
            if (filtered.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center py-8">No transactions found</p>';
            } else {
                container.innerHTML = filtered.map(transaction => `
                    <div class="transaction-item bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 card-hover">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium">${transaction.description || transaction.category}</h4>
                                <p class="text-sm text-gray-500 dark:text-gray-400">${transaction.date} ‚Ä¢ ${transaction.category}</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="font-bold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}">
                                    ${transaction.type === 'income' ? '+' : '-'}${formatCurrency(transaction.amount)}
                                </span>
                                <div class="flex space-x-1">
                                    <button onclick="openEditModal(${JSON.stringify(transaction).replace(/"/g, '&quot;')})" class="p-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="openDeleteModal(${transaction.id})" class="p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateAnalytics() {
            updateTrendsChart();
            updateCategoryChart();
            updateAnalyticsStats();
        }

        function updateTrendsChart() {
            const ctx = document.getElementById('trendsChart').getContext('2d');
            
            if (charts.trends) {
                charts.trends.destroy();
            }

            const monthlyData = {};
            transactions.forEach(t => {
                const month = t.date.substring(0, 7);
                if (!monthlyData[month]) {
                    monthlyData[month] = { income: 0, expenses: 0 };
                }
                monthlyData[month][t.type === 'income' ? 'income' : 'expenses'] += t.amount;
            });

            const months = Object.keys(monthlyData).sort();
            const incomeData = months.map(m => monthlyData[m].income);
            const expenseData = months.map(m => monthlyData[m].expenses);

            const t = translations[currentLanguage];
            charts.trends = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: t.income,
                        data: incomeData,
                        borderColor: '#10B981',
                        backgroundColor: '#10B981',
                        tension: 0.4
                    }, {
                        label: t.expense,
                        data: expenseData,
                        borderColor: '#EF4444',
                        backgroundColor: '#EF4444',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: document.documentElement.classList.contains('dark') ? '#fff' : '#000'
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: { color: document.documentElement.classList.contains('dark') ? '#fff' : '#000' },
                            grid: { color: document.documentElement.classList.contains('dark') ? '#374151' : '#E5E7EB' }
                        },
                        x: {
                            ticks: { color: document.documentElement.classList.contains('dark') ? '#fff' : '#000' },
                            grid: { color: document.documentElement.classList.contains('dark') ? '#374151' : '#E5E7EB' }
                        }
                    }
                }
            });
        }

        function updateCategoryChart() {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            if (charts.category) {
                charts.category.destroy();
            }

            const categoryData = {};
            transactions.filter(t => t.type === 'expense').forEach(t => {
                categoryData[t.category] = (categoryData[t.category] || 0) + t.amount;
            });

            const labels = Object.keys(categoryData);
            const data = Object.values(categoryData);

            charts.category = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#EF4444', '#F97316', '#F59E0B', '#EAB308',
                            '#84CC16', '#22C55E', '#10B981', '#14B8A6',
                            '#06B6D4', '#0EA5E9', '#3B82F6', '#6366F1'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: document.documentElement.classList.contains('dark') ? '#fff' : '#000'
                            }
                        }
                    }
                }
            });
        }

        function toggleSearch() {
            const searchBar = document.getElementById('searchBar');
            searchBar.classList.toggle('hide');
            if (!searchBar.classList.contains('hide')) {
                document.getElementById('searchInput').focus();
            }
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            if (searchTerm) {
                const filtered = transactions.filter(t => 
                    (t.description && t.description.toLowerCase().includes(searchTerm)) ||
                    t.category.toLowerCase().includes(searchTerm) ||
                    t.amount.toString().includes(searchTerm)
                );
                displayFilteredTransactions(filtered);
            } else {
                updateTransactionsList();
            }
        }

        function displayFilteredTransactions(filtered) {
            const container = document.getElementById('transactionsList');
            if (filtered.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center py-8">No transactions found</p>';
            } else {
                container.innerHTML = filtered.map(transaction => `
                    <div class="transaction-item bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 card-hover">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium">${transaction.description || transaction.category}</h4>
                                <p class="text-sm text-gray-500 dark:text-gray-400">${transaction.date} ‚Ä¢ ${transaction.category}</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="font-bold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}">
                                    ${transaction.type === 'income' ? '+' : '-'}${formatCurrency(transaction.amount)}
                                </span>
                                <div class="flex space-x-1">
                                    <button onclick="openEditModal(${JSON.stringify(transaction).replace(/"/g, '&quot;')})" class="p-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="openDeleteModal(${transaction.id})" class="p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function exportData() {
            if (transactions.length === 0) {
                showNotification('No data to export', 'warning');
                return;
            }

            const csvContent = [
                ['Date', 'Type', 'Category', 'Description', 'Amount'],
                ...transactions.map(t => [t.date, t.type, t.category, t.description || '', t.amount])
            ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `budget-tracker-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            showNotification('Data exported successfully!', 'success');
            document.getElementById('menuDropdown').classList.add('hide');
        }

        function openQuickAddModal(type) {
            openAddModal();
            document.getElementById('transactionType').value = type;
            updateCategoryOptions();
        }

        function setSavingsTarget() {
            const target = parseFloat(document.getElementById('savingsTarget').value);
            if (!target || target <= 0) {
                showNotification('Please enter a valid savings target', 'warning');
                return;
            }

            updateSavingsProgress(target);
            showNotification('Savings target set successfully!', 'success');
        }

        function updateSavingsProgress(target) {
            const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            const currentSavings = income - expenses;
            const percentage = Math.max(0, Math.min(100, (currentSavings / target) * 100));

            document.getElementById('savingsProgress').classList.remove('hide');
            document.getElementById('savingsPercentage').textContent = `${percentage.toFixed(1)}%`;
            document.getElementById('savingsProgressBar').style.width = `${percentage}%`;
            
            let status = '';
            if (percentage >= 100) {
                status = `üéâ Congratulations! You've exceeded your savings target!`;
            } else if (percentage >= 75) {
                status = `üöÄ Great progress! You're almost there!`;
            } else if (percentage >= 50) {
                status = `üìà Good work! Keep it up!`;
            } else {
                status = `üí™ You can do it! Stay focused on your goal.`;
            }
            document.getElementById('savingsStatus').textContent = status;
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 text-white max-w-sm ${
                type === 'success' ? 'bg-green-500' :
                type === 'warning' ? 'bg-yellow-500' :
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function updateAnalyticsStats() {
            document.getElementById('totalTransactions').textContent = transactions.length;
            
            const expenses = transactions.filter(t => t.type === 'expense');
            const avgDaily = expenses.length > 0 ? 
                expenses.reduce((sum, t) => sum + t.amount, 0) / expenses.length : 0;
            document.getElementById('avgDailySpend').textContent = formatCurrency(avgDaily).replace('.00', '');
            
            const highestExpense = expenses.length > 0 ? 
                Math.max(...expenses.map(t => t.amount)) : 0;
            document.getElementById('highestExpense').textContent = formatCurrency(highestExpense).replace('.00', '');
            
            const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const totalExpenses = expenses.reduce((sum, t) => sum + t.amount, 0);
            const savingsRate = income > 0 ? ((income - totalExpenses) / income * 100) : 0;
            document.getElementById('savingsRate').textContent = `${Math.max(0, savingsRate).toFixed(1)}%`;
        }

        function updateFooterBalance() {
            const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            const balance = income - expenses;
            document.getElementById('footerBalance').textContent = formatCurrency(balance);
        }
    </script>
</body>
</html>
